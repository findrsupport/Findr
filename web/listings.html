<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Listings ‚Äî Findr‚Ñ¢</title>
  <meta name="description" content="Browse mock listings in the Findr‚Ñ¢ demo with filters and sorting.">
  <style>
    :root {
      --brand: #fac241;
      --bg: #1f262d;
      --fg: #f1f1f1;
      --muted: #9aa4b2;
      --card: #2a323b;
      --link: #fac241;
      --border: #3a4149;
      --maxw: 1200px;
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    [data-theme="light"] {
      --bg: #ffffff;
      --fg: #111111;
      --muted: #666666;
      --card: #f8f9fa;
      --link: #fac241;
      --border: #e0e0e0;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
    }
    html, body { height: 100%; }
    body { margin:0; background: var(--bg); color: var(--fg); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial; line-height: 1.6; display:flex; flex-direction:column; }
    a { color: var(--link); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .container { width: min(var(--maxw), 94%); margin-inline: auto; }
    .nav { position: sticky; top: 0; z-index: 50; backdrop-filter: saturate(180%) blur(8px); background: color-mix(in oklab, var(--bg) 82%, transparent); border-bottom: 1px solid var(--border); }
    .nav-inner { display:flex; align-items:center; justify-content:space-between; padding:12px 0; }
    .brand a { color: var(--fg); font-weight:800; }
    .nav-links { display:flex; gap:20px; }
    .nav-links a { color: var(--fg); opacity: .9; }
    .nav-links a.active { color: var(--brand); font-weight:600; }
    .theme-btn { border:1px solid var(--border); background:var(--card); color:var(--fg); padding:6px 10px; border-radius:10px; cursor:pointer; font-size:14px; }

    main { flex: 1; padding: 28px 0 40px; }
    h1 { font-size: clamp(26px, 4.2vw, 40px); margin: 0 0 6px; }
    .sub { color: var(--muted); margin: 0 0 18px; }

    .controls {
      display: flex; gap: 10px; flex-wrap: wrap; align-items: center;
      background: var(--card); border:1px solid var(--border); border-radius: 12px; padding:12px;
    }
    .input, .select, .chip {
      background: transparent; color: var(--fg); border:1px solid var(--border); border-radius: 10px; padding: 8px 10px;
    }
    .chip { cursor: pointer; }
    .chip.active { border-color: var(--brand); box-shadow: 0 0 0 2px color-mix(in oklab, var(--brand) 35%, transparent); }
    .grid {
      margin-top: 16px;
      display:grid; gap:16px;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    }
    .card {
      background: var(--card); border:1px solid var(--border); border-radius: 14px; overflow: hidden; box-shadow: var(--shadow);
      display:flex; flex-direction:column;
    }
    .card img { width:100%; height:200px; object-fit: cover; display:block; }
    .card-body { padding: 12px 14px 14px; display:flex; flex-direction:column; gap:6px; }
    .price { font-weight: 800; color: var(--brand); }
    .meta { color: var(--muted); font-size: 14px; }
    .card-foot { display:flex; align-items:center; justify-content:space-between; margin-top: 8px; color: var(--muted); font-size: 13px; }

    footer { border-top:1px solid var(--border); padding:18px 0; font-size:13px; color:var(--muted); }
    .footer-row { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
    .badge { height:22px; opacity:.9; }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="container nav-inner">
      <div class="brand"><a href="index.html">Findr‚Ñ¢</a></div>
      <div class="nav-links" role="navigation" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="listings.html" class="active">Listings</a>
        <a href="map.html">Map</a>
      </div>
      <button id="themeToggle" class="theme-btn" aria-label="Toggle theme">üåô</button>
    </div>
  </nav>

  <main class="container">
    <header>
      <h1>Browse Listings</h1>
      <p class="sub">Mock data for UI/UX preview. Filters and sorting are simulated.</p>
    </header>

    <section class="controls" aria-label="Filters and sorting">
      <input id="q" class="input" type="search" placeholder="Search by city, address, MLS¬Æ‚Ä¶" />
      <select id="type" class="select">
        <option value="">Any Type</option>
        <option>House</option>
        <option>Condo</option>
        <option>Townhouse</option>
      </select>
      <select id="sort" class="select">
        <option value="price-desc">Price: High ‚Üí Low</option>
        <option value="price-asc">Price: Low ‚Üí High</option>
        <option value="beds-desc">Beds: Most ‚Üí Fewest</option>
      </select>
      <button class="chip" data-chip="hasPhotos">üì∑ Photos</button>
      <button class="chip" data-chip="new">üÜï New</button>
      <button class="chip" data-chip="openHouse">üóìÔ∏è Open House</button>
    </section>

    <section id="grid" class="grid" aria-live="polite"></section>
  </main>

  <footer>
    <div class="container footer-row">
      <img class="badge" src="assets/powered-by-realtor.svg" alt="Powered by REALTOR.ca">
      <span>Brokerage (for demo): RE/MAX All Points Realty ‚Ä¢ ¬© <span id="year"></span> Findr‚Ñ¢</span>
    </div>
    <div class="container">
      REALTOR¬Æ, REALTORS¬Æ, and the REALTOR¬Æ logo are controlled by CREA and identify real estate professionals who are members of CREA.
      MLS¬Æ, Multiple Listing Service¬Æ, and the associated logos are owned by CREA. Demo content only.
    </div>
  </footer>

  <script>
    // Theme
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const saved = localStorage.getItem('theme') || 'dark';
    root.setAttribute('data-theme', saved);
    btn.textContent = saved === 'dark' ? 'üåô' : '‚òÄÔ∏è';
    btn.addEventListener('click', () => {
      const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      btn.textContent = next === 'dark' ? 'üåô' : '‚òÄÔ∏è';
    });

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Data + UI
    const grid = document.getElementById('grid');
    const q = document.getElementById('q');
    const type = document.getElementById('type');
    const sort = document.getElementById('sort');
    const chips = [...document.querySelectorAll('.chip')];

    let data = [];
    let flags = { hasPhotos:false, new:false, openHouse:false };

    chips.forEach(ch => ch.addEventListener('click', () => {
      const k = ch.dataset.chip;
      flags[k] = !flags[k];
      ch.classList.toggle('active', flags[k]);
      render();
    }));

    [q, type, sort].forEach(el => el.addEventListener('input', render));

    fetch('data/listings.json')
      .then(r => r.json())
      .then(json => { data = json; render(); })
      .catch(() => { grid.innerHTML = '<p class="sub">Could not load listings.json</p>'; });

    function render() {
      const query = q.value.trim().toLowerCase();
      let items = data.filter(it => {
        const matchesQuery = !query || (it.city + ' ' + it.address + ' ' + (it.mls||'') ).toLowerCase().includes(query);
        const matchesType = !type.value || it.type === type.value;
        const matchesFlags = (!flags.hasPhotos || it.photos?.length) &&
                             (!flags.new || it.tags?.includes('new')) &&
                             (!flags.openHouse || it.tags?.includes('openHouse'));
        return matchesQuery && matchesType && matchesFlags;
      });

      const [key, dir] = sort.value.split('-');
      items.sort((a,b) => {
        const vA = key === 'price' ? a.price : key === 'beds' ? a.beds : 0;
        const vB = key === 'price' ? b.price : key === 'beds' ? b.beds : 0;
        return dir === 'asc' ? vA - vB : vB - vA;
      });

      grid.innerHTML = items.map(card).join('');
    }

    function card(it) {
      const price = new Intl.NumberFormat('en-CA', {style:'currency', currency:'CAD', maximumFractionDigits:0}).format(it.price);
      const photo = (it.photos && it.photos[0]) || 'https://images.unsplash.com/photo-1501183638710-841dd1904471?q=80&w=1200&auto=format&fit=crop';
      return `
      <article class="card" aria-label="${it.address}, ${it.city}">
        <img src="${photo}" alt="${it.address} photo">
        <div class="card-body">
          <div class="price">${price}</div>
          <div>${it.address}</div>
          <div class="meta">${it.city} ‚Ä¢ ${it.type} ‚Ä¢ ${it.beds} bd ‚Ä¢ ${it.baths} ba ‚Ä¢ ${it.sqft.toLocaleString()} sqft</div>
          <div class="card-foot">
            <span>${it.brokerage || 'Demo Brokerage'}</span>
            <span>MLS¬Æ ${it.mls || '‚Äî'}</span>
          </div>
        </div>
      </article>`;
    }
  </script>
</body>
</html>
